{% extends "ong/base.html" %}
{% load static %}
{% block title %}{{ gato.nome }} — Adoção{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/adocao_detail.css' %}">
{% endblock %}

{% block content %}
<div class="detail-hero py-4">
  <div class="container">
    <div class="row g-4 align-items-center">
      <!-- Foto grande -->
      <div class="col-lg-5">
        <div class="card image-card">
          {% if gato.imagem %}
            <img src="{{ gato.imagem.url }}" alt="{{ gato.nome }}" class="img-fluid main-photo">
          {% else %}
            <img src="{% static 'img/placeholder-cat.jpg' %}" alt="sem imagem" class="img-fluid main-photo">
          {% endif %}
        </div>
      </div>

      <!-- Info ao lado -->
      <div class="col-lg-7">
        <h1 class="cat-name mb-1">{{ gato.nome }}</h1>
        <p class="cat-meta text-muted mb-3">
            {{ gato.idade }} •
            {% if gato.sexo == 'M' %}
                Macho
            {% elif gato.sexo == 'F' %}
                Fêmea
            {% else %}
                Sexo
            {% endif %}
        </p>
        <h5 class="section-title">História de {{ gato.nome }}</h5>
        <p class="cat-history text-muted mb-3">{{ gato.descricao|default:"Sem descrição." }}</p>

         <!-- BADGES dinâmicas: só mostram se o campo existir / for truthy -->
        <div class="badges mb-3">
          {% if gato.temperamento %}
            <span class="badge tag">{{ gato.temperamento }}</span>
          {% endif %}

          {% if gato.cuidado %}
            <span class="badge tag">{{ gato.cuidado }}</span>
          {% endif %}
          
          {% if gato.moradia.casa_com_quintal or gato.moradia.apartamento %}
          <span class="badge tag">
            Vive bem em:
            {% if gato.moradia.casa_com_quintal %}
              Casa com quintal
            {% endif %}

            {% if gato.moradia.apartamento %}
              {% if gato.moradia.casa_com_quintal %}, {% endif %}
              Apartamento
            {% endif %}
          </span>
          {% endif %}

          {% if gato.sociavel.gatos or gato.sociavel.desconhecidos or gato.sociavel.cachorros or gato.sociavel.criancas or gato.sociavel.nao_sociavel %}
          <span class="badge tag">
            Sociável com:
            {% if gato.sociavel.gatos %}
              Gatos
            {% endif %}

            {% if gato.sociavel.desconhecidos %}
              {% if gato.sociavel.gatos %}, {% endif %}
              Desconhecidos
            {% endif %}

            {% if gato.sociavel.cachorros %}
              {% if gato.sociavel.gatos or gato.sociavel.desconhecidos %}, {% endif %}
              Cachorros
            {% endif %}

            {% if gato.sociavel.criancas %}
              {% if gato.sociavel.gatos or gato.sociavel.desconhecidos or gato.sociavel.cachorros %}, {% endif %}
              Crianças
            {% endif %}

            {% if gato.sociavel.nao_sociavel %}
              {% if gato.sociavel.gatos or gato.sociavel.desconhecidos or gato.sociavel.cachorros or gato.sociavel.criancas %}, {% endif %}
              Não sociável
            {% endif %}
          </span>
          {% endif %}

          {% if gato.castrado %}
            <span class="badge tag">Castrado</span>
          {% endif %}

          {% if gato.vacinado %}
            <span class="badge tag">Vacinado</span>
          {% endif %}
          
          {% if gato.vermifugado %}
            <span class="badge tag">Vermifugado</span>
          {% endif %}
        </div>

        <div class="botão">
        <a href="{% url 'adocoes:formulario_adocao' %}?gato={{ gato.pk }}" class="btn btn-adotar btn-lg">
          <img src="{% static 'img/patinha.png' %}" alt="Patinha" class="patinha"> Quero Adotar
        </a>
        </div>
      </div>
      
    </div>

    <!-- Outros gatos -->
    <div class="other-section mt-5">
      <h3 class="other-title">Outros gatos para adoção</h3>
      <div class="row g-3 mt-3">
        {% for o in other_gatos %}
          <div class="col-md-3 col-sm-6">
            <a href="{% url 'adocoes:detail' o.pk %}" class="card-link">
                <div class="card card-cat small-card h-100">
                    {% if o.imagem %}
                        <img src="{{ o.imagem.url }}" class="card-img-top small-img" alt="{{ o.nome }}">
                    {% else %}
                        <img src="{% static 'img/placeholder-thumb.jpg' %}" class="card-img-top small-img" alt="sem imagem">
                    {% endif %}

                    <div class="card-body py-2 px-3">
                      <h6 class="mb-1 small-name">{{ o.nome }}</h6>
                      <p class="small-meta text-muted mb-0">

                          {% if o.idade %}{{ o.idade }}{% else %}—{% endif %} |

                          {% if o.sexo == 'M' %}
                              Macho
                          {% elif o.sexo == 'F' %}
                              Fêmea
                          {% else %}
                              Sexo
                          {% endif %}

                          {% if o.lar_temporario %}
                              | Lar Temporário
                          {% endif %}
                      </p>
                  </div>
                </div>
            </a>
        </div>
        {% endfor %}
      </div>

      <div class="mt-3 text-end">
        <a href="{% url 'adocoes:lista' %}" class="link-more">Ver Todos →</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}